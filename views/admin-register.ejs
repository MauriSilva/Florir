<%- include("partials/layout") %>
    <%- include("partials/header") %>

        <main class="container" style="max-width: 800px; margin: 4rem auto;">
            <div class="glass-card">
                <h2 style="text-align: center; margin-bottom: 1.5rem;">Cadastrar Novo Usuário</h2>

                <form action="/admin/users/create" method="POST">
                    <div class="form-group">
                        <label for="username">Nome de Usuário</label>
                        <input type="text" id="username" name="username" required>
                    </div>

                    <div class="form-group">
                        <label for="password">Senha</label>
                        <input type="password" id="password" name="password" required>
                    </div>

                    <div class="form-group" style="display: flex; align-items: center; gap: 10px; margin-top: 1rem;">
                        <input type="checkbox" id="isAdmin" name="isAdmin" style="width: auto; margin: 0;">
                        <label for="isAdmin" style="margin: 0; cursor: pointer;">É Administrador?</label>
                    </div>

                    <button type="submit" class="btn" style="width: 100%; margin-top: 1.5rem;">Cadastrar
                        Usuário</button>
                </form>

                <a href="/admin"
                    style="display:block; text-align:center; margin-top:20px; color: var(--primary); font-weight: 600;">
                    ← Voltar ao Painel
                </a>
            </div>

            <div class="glass-card" style="margin-top: 2rem;">
                <h3 style="text-align: center; margin-bottom: 1.5rem;">Usuários Cadastrados</h3>
                <div class="table-responsive">
                    <table class="admin-table" style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr>
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #eee;">Usuário</th>
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #eee;">Admin</th>
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #eee;">Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% if (users && users.length> 0) { %>
                                <% users.forEach(u=> { %>
                                    <tr>
                                        <td style="padding: 10px; border-bottom: 1px solid #eee;">
                                            <%= u.username %>
                                        </td>
                                        <td style="padding: 10px; border-bottom: 1px solid #eee;">
                                            <%= u.isAdmin ? 'Sim' : 'Não' %>
                                        </td>
                                        <td style="padding: 10px; border-bottom: 1px solid #eee;">
                                            <a href="/admin/users/edit/<%= u.id %>"
                                                style="color: #3498db; margin-right: 10px;"><i
                                                    class="fa-solid fa-pen"></i></a>
                                            <% if (u.username !=='admin' ) { %>
                                                <form action="/admin/users/delete/<%= u.id %>" method="POST"
                                                    style="display:inline;">
                                                    <button type="submit"
                                                        style="background:none; border:none; color: #e74c3c; cursor: pointer;"
                                                        onclick="return confirm('Excluir usuário <%= u.username %>?');">
                                                        <i class="fa-solid fa-trash"></i>
                                                    </button>
                                                </form>
                                                <% } %>
                                        </td>
                                    </tr>
                                    <% }) %>
                                        <% } else { %>
                                            <tr>
                                                <td colspan="3" style="padding: 10px; text-align: center;">
                                                    Nenhum usuário encontrado.</td>
                                            </tr>
                                            <% } %>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>

        <%- include("partials/footer") %>