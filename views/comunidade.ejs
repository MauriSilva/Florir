<%- include("partials/layout") %>
<%- include("partials/header") %>

<main class="glass-container">

  <h1>ğŸŒ¼ Comunidade Florir</h1>
  <p>Aqui vocÃª encontra contatos importantes e pode deixar sua mensagem para o projeto.</p>

  <!-- CONTATOS ÃšTEIS -->
  <section>
    <h2>ğŸ“ Contatos de Apoio Emocional</h2>

    <div class="contact-list">

      <div class="contact-card">
        <h3>CVV â€“ 188</h3>
        <p>Atendimento gratuito e sigiloso 24h.</p>
        <a href="https://www.cvv.org.br" target="_blank">Acessar site</a>
      </div>

      <div class="contact-card">
        <h3>SAMU â€“ 192</h3>
        <p>EmergÃªncias mÃ©dicas.</p>
      </div>

      <div class="contact-card">
        <h3>Disque SaÃºde â€“ 136</h3>
        <p>InformaÃ§Ãµes sobre serviÃ§os de saÃºde pÃºblica.</p>
      </div>

      <div class="contact-card">
        <h3>Mapa da SaÃºde Florir</h3>
        <p>Encontre hospitais, clÃ­nicas e ONGs perto de vocÃª.</p>
        <a href="/mapas">Abrir mapa</a>
      </div>

    </div>
  </section>

  <hr>

  <!-- COMENTÃRIOS -->
  <section>
    <h2>ğŸ’¬ Deixe seu comentÃ¡rio</h2>

    <form action="/comunidade" method="POST">
      <label>Seu nome:</label>
      <input type="text" name="name" required>

      <label>Sua mensagem:</label>
      <textarea name="message" required></textarea>

      <button type="submit">Enviar comentÃ¡rio</button>
    </form>

    <h3 class="mt-1">ComentÃ¡rios da Comunidade</h3>

    <% if (comments.length === 0) { %>
      <p>Nenhum comentÃ¡rio ainda. Seja o primeiro a participar!</p>
    <% } %>

    <% comments.forEach(c => { %>
  <div class="comment-card">
    <strong><%= c.name %></strong>
    <p><%= c.message %></p>
    <small><%= c.createdAt.toLocaleString("pt-BR") %></small>

    <% if (user && user.isAdmin) { %>
      <form action="/comunidade/deletar/<%= c.id %>" method="POST" style="margin-top: 10px;">
        <button class="btn-delete-comment" onclick="return confirm('Excluir este comentÃ¡rio?')">
          Excluir
        </button>
      </form>
    <% } %>

  </div>
<% }) %>

  </section>

</main>

<%- include("partials/footer") %>
